
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importing Relevant Libraries &#8212; CA4015 Assignment 1 - John Weldon, Liam Carroll, Nathan Crone</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introdcution and Description of Datasets" href="Introduction and Description of Datasets.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/k-means.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4015 Assignment 1 - John Weldon, Liam Carroll, Nathan Crone</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="#">
   Importing Relevant Libraries
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction and Description of Datasets.html">
   Introdcution and Description of Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_and_Desc_of_Data.html">
   Introdcution and Description of Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Notebook_Structure.html">
   Notebook Structure
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Clustering.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Clustering.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/Clustering.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Importing Relevant Libraries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general">
     General
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-clustering">
     For clustering
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-principal-component-analysis">
     For principal component analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#for-plotting">
     For plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-in-the-data">
   1. Reading In The Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-pvl-delta-model">
     Read in data from PVL-Delta model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inspect-the-data">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#processing">
       Processing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-the-orl-model">
     Read in data from the ORL model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Processing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-the-vpp-model">
     Read in data from the VPP model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Processing
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#standardising-the-data">
   2. Standardising the Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standardising-the-features">
     Standardising the features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-group-feature-back-in">
     Add the group feature back in
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#consideration-of-clustering-algorithms">
   Consideration of Clustering Algorithms
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id10">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-the-kmeans-algorithm">
     Silhouette Scores for the KMeans Algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-elbow-curve-of-the-distortion-that-each-cluster-number-gives">
       Plot the elbow curve of the distortion that each cluster number gives
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-spectral-clustering-algorithm">
     Silhouette Scores for Spectral Clustering Algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-rbf">
       Spectral Clustering with
       <em>
        affinity=’rbf’
       </em>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-nearest-neighbors">
       Spectral Clustering with
       <em>
        affinity=’nearest_neighbors’
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cluster-the-data">
   4. Cluster the data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-out-which-of-the-clusters-each-df-row-is-in">
     Find out which of the clusters each df row is in
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       Cluster the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-the-centroids-of-the-clusters">
       Calculate the centroids of the clusters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-a-new-column-to-the-original-data-with-the-cluster-each-row-is-in">
       Add a new column to the original data with the cluster each row is in
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id14">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-analysis">
   5. Principal Component Analysis
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id15">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-dataframe-which-pca-is-being-performed-on">
     Inspect dataframe which PCA is being performed on
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-pca-to-project-the-data-to-2-dimensions">
     Use PCA to project the data to 2 dimensions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-how-much-variance-these-2-axes-explain">
     Look at how much variance these 2 axes explain
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-these-principal-component-columns-to-the-rest-of-the-data">
     Add these principal component columns to the rest of the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id16">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-clusters-with-the-pca-axes">
   6. Plot the clusters with the PCA axes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id17">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-clusters">
     Plot the clusters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#choose-the-columns-to-plot">
       Choose the columns to plot
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualise-2d-projection">
       Visualise 2D projection
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-original-data">
       Plot the original data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-data-colouring-the-different-groups">
       Plot the data colouring the different groups
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-this-data-colouring-the-different-clusters">
       Plot this data colouring the different clusters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-this-data-with-the-clusters-and-their-centroids">
       Plot this data with the clusters and their centroids
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id18">
   =============================================================
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-the-clusters">
   7. Analyse the clusters
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id19">
   =============================================================
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#see-how-the-old-and-young-fall-into-these-clusters">
     See how the ‘Old’ and ‘Young’ fall into these clusters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-dataframe-showing-how-many-people-people-fell-into-each-cluster">
       Create a dataframe showing how many people people fell into each cluster
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#change-young-to-1-and-old-to-np-nan">
       Change ‘young’ to 1 and ‘old’ to np.nan
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-dataframe-showing-how-many-young-people-fell-into-each-cluster">
       Create a dataframe showing how many young people fell into each cluster
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-dataframe-showing-how-many-old-people-fell-into-each-cluster">
       Create a dataframe showing how many old people fell into each cluster
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#output-how-many-young-and-old-people-fell-into-each-cluster">
       Output how many ‘young’ and ‘old’ people fell into each cluster
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="importing-relevant-libraries">
<h1>Importing Relevant Libraries<a class="headerlink" href="#importing-relevant-libraries" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-clustering">
<h2>For clustering<a class="headerlink" href="#for-clustering" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">SpectralClustering</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-principal-component-analysis">
<h2>For principal component analysis<a class="headerlink" href="#for-principal-component-analysis" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">normalize</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-plotting">
<h2>For plotting<a class="headerlink" href="#for-plotting" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h1>=============================================================<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="reading-in-the-data">
<h1>1. Reading In The Data<a class="headerlink" href="#reading-in-the-data" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id2">
<h1>=============================================================<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="read-in-data-from-pvl-delta-model">
<h2>Read in data from PVL-Delta model<a class="headerlink" href="#read-in-data-from-pvl-delta-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameter_igt_pvl_delta.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="inspect-the-data">
<h3>Inspect the data<a class="headerlink" href="#inspect-the-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>SubID</th>
      <th>LR</th>
      <th>Outcome_Sens</th>
      <th>Response_cons</th>
      <th>Loss_Aver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>1</td>
      <td>0.159011</td>
      <td>0.487522</td>
      <td>0.686815</td>
      <td>0.954498</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>2</td>
      <td>0.064666</td>
      <td>0.511008</td>
      <td>1.391790</td>
      <td>0.295529</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>3</td>
      <td>0.113089</td>
      <td>0.465141</td>
      <td>0.918734</td>
      <td>0.533232</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>4</td>
      <td>0.089273</td>
      <td>0.500391</td>
      <td>0.703737</td>
      <td>0.869859</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>5</td>
      <td>0.233898</td>
      <td>0.488053</td>
      <td>0.897867</td>
      <td>0.511095</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_pvl_delta</span><span class="p">[</span><span class="s2">&quot;LR&quot;</span><span class="p">],</span> <span class="n">df_pvl_delta</span><span class="p">[</span><span class="s2">&quot;Outcome_Sens&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x16727919fd0&gt;
</pre></div>
</div>
<img alt="_images/Clustering_16_1.png" src="_images/Clustering_16_1.png" />
</div>
</div>
</div>
<div class="section" id="processing">
<h3>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h3>
<p>‘SubID’ column can be dropped as it is not used for analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SubID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Outcome_Sens</th>
      <th>Response_cons</th>
      <th>Loss_Aver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.159011</td>
      <td>0.487522</td>
      <td>0.686815</td>
      <td>0.954498</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.064666</td>
      <td>0.511008</td>
      <td>1.391790</td>
      <td>0.295529</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.113089</td>
      <td>0.465141</td>
      <td>0.918734</td>
      <td>0.533232</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.089273</td>
      <td>0.500391</td>
      <td>0.703737</td>
      <td>0.869859</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.233898</td>
      <td>0.488053</td>
      <td>0.897867</td>
      <td>0.511095</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="read-in-data-from-the-orl-model">
<h2>Read in data from the ORL model<a class="headerlink" href="#read-in-data-from-the-orl-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameter_igt_orl.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Inspect the data<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subjID</th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
      <th>A+-A-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>old</td>
      <td>0.324444</td>
      <td>0.068862</td>
      <td>1.502130</td>
      <td>2.523191</td>
      <td>-5.547480</td>
      <td>0.255581</td>
    </tr>
    <tr>
      <th>1</th>
      <td>old</td>
      <td>0.885744</td>
      <td>0.120145</td>
      <td>0.012591</td>
      <td>3.193244</td>
      <td>-9.159800</td>
      <td>0.765598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>old</td>
      <td>0.318205</td>
      <td>0.078128</td>
      <td>1.927309</td>
      <td>0.615708</td>
      <td>9.272336</td>
      <td>0.240077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>old</td>
      <td>0.728192</td>
      <td>0.106737</td>
      <td>0.388407</td>
      <td>2.595746</td>
      <td>-2.239555</td>
      <td>0.621455</td>
    </tr>
    <tr>
      <th>4</th>
      <td>old</td>
      <td>0.356229</td>
      <td>0.091987</td>
      <td>1.810674</td>
      <td>0.508605</td>
      <td>9.825699</td>
      <td>0.264241</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id4">
<h3>Processing<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>‘subjID’ column in input file is actually the ‘group’ column based on its contents. Thus, rename the column as so.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;subjID&#39;</span><span class="p">:</span><span class="s1">&#39;group&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_orl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
      <th>A+-A-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>old</td>
      <td>0.324444</td>
      <td>0.068862</td>
      <td>1.502130</td>
      <td>2.523191</td>
      <td>-5.547480</td>
      <td>0.255581</td>
    </tr>
    <tr>
      <th>1</th>
      <td>old</td>
      <td>0.885744</td>
      <td>0.120145</td>
      <td>0.012591</td>
      <td>3.193244</td>
      <td>-9.159800</td>
      <td>0.765598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>old</td>
      <td>0.318205</td>
      <td>0.078128</td>
      <td>1.927309</td>
      <td>0.615708</td>
      <td>9.272336</td>
      <td>0.240077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>old</td>
      <td>0.728192</td>
      <td>0.106737</td>
      <td>0.388407</td>
      <td>2.595746</td>
      <td>-2.239555</td>
      <td>0.621455</td>
    </tr>
    <tr>
      <th>4</th>
      <td>old</td>
      <td>0.356229</td>
      <td>0.091987</td>
      <td>1.810674</td>
      <td>0.508605</td>
      <td>9.825699</td>
      <td>0.264241</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="read-in-data-from-the-vpp-model">
<h2>Read in data from the VPP model<a class="headerlink" href="#read-in-data-from-the-vpp-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameters_igt_vpp.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id5">
<h3>Inspect the data<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>SubID</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>1</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>2</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>3</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>4</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>5</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id6">
<h3>Processing<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>‘SubID’ column is dropped as before as it is not used for analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SubID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_vpp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h1>=============================================================<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="standardising-the-data">
<h1>2. Standardising the Data<a class="headerlink" href="#standardising-the-data" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id8">
<h1>=============================================================<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h1>
<p>In the paper, Lili concludes that the VPP model was the best-fitting model in terms of short-term prediction performance for the IGT task, as measured by one-step-ahead leave-one-out information criterion (LOOIC). Therefore, we will begin by analysing this dataset. The <em>‘group’</em> column will not be used as a feature for the clustering analysis, so we will exclude this from the processing for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp_sd</span> <span class="o">=</span> <span class="n">df_vpp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>If we look at the ranges of the variables in the <em>df_vpp</em> DataFrame and their distributions…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp_sd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.070824</td>
      <td>0.560575</td>
      <td>1.329323</td>
      <td>0.952138</td>
      <td>0.460940</td>
      <td>-0.720379</td>
      <td>0.406367</td>
      <td>0.622995</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.064683</td>
      <td>0.111139</td>
      <td>0.198041</td>
      <td>0.580621</td>
      <td>1.185591</td>
      <td>1.102656</td>
      <td>0.187483</td>
      <td>0.066657</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.027454</td>
      <td>0.352471</td>
      <td>0.879707</td>
      <td>0.193857</td>
      <td>-2.977630</td>
      <td>-2.912838</td>
      <td>0.042780</td>
      <td>0.452978</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.038294</td>
      <td>0.448811</td>
      <td>1.202790</td>
      <td>0.528927</td>
      <td>-0.287230</td>
      <td>-1.634716</td>
      <td>0.256420</td>
      <td>0.569390</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.050247</td>
      <td>0.590334</td>
      <td>1.316736</td>
      <td>0.760613</td>
      <td>0.593115</td>
      <td>-0.779120</td>
      <td>0.439912</td>
      <td>0.640917</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.078495</td>
      <td>0.646090</td>
      <td>1.428836</td>
      <td>1.292569</td>
      <td>1.419412</td>
      <td>0.137599</td>
      <td>0.565139</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.617431</td>
      <td>0.818137</td>
      <td>1.938694</td>
      <td>2.698527</td>
      <td>2.559126</td>
      <td>1.583109</td>
      <td>0.858421</td>
      <td>0.744017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Visualising the distributions of the different variables</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_vpp_sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x167297f1760&gt;
</pre></div>
</div>
<img alt="_images/Clustering_39_1.png" src="_images/Clustering_39_1.png" />
</div>
</div>
<p>From the pair plot above, we can clearly see that many of the variables have either positively or negatively skewed distributions. There also appears to be many outliers in each distribution and the different parameters don’t share a common scale.</p>
<p>To remedy this and also to ensure sound clustering analysis, we are going to <strong>standardise</strong> the dataset. We may also perform some principal component analysis on the data and to allow for this, the data will need to be standardised anyway.</p>
<div class="section" id="standardising-the-features">
<h2>Standardising the features<a class="headerlink" href="#standardising-the-features" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Scaling the data</span>
<span class="n">array_vpp_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_vpp_sd</span><span class="p">)</span>

<span class="c1">#Normalizing the data</span>
<span class="n">array_vpp_norm</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">array_vpp_scaled</span><span class="p">)</span>

<span class="c1">#Converting the standardised array back to a DataFrame</span>
<span class="n">df_vpp_sd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array_vpp_norm</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_vpp_sd</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp_sd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.020336</td>
      <td>0.011143</td>
      <td>-0.007340</td>
      <td>-0.000307</td>
      <td>-0.002791</td>
      <td>-0.002880</td>
      <td>0.008144</td>
      <td>0.009668</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.318101</td>
      <td>0.357772</td>
      <td>0.363945</td>
      <td>0.359315</td>
      <td>0.360013</td>
      <td>0.358561</td>
      <td>0.359069</td>
      <td>0.357698</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.404640</td>
      <td>-0.777566</td>
      <td>-0.807861</td>
      <td>-0.669812</td>
      <td>-0.786274</td>
      <td>-0.700567</td>
      <td>-0.799632</td>
      <td>-0.649735</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.262365</td>
      <td>-0.320904</td>
      <td>-0.235453</td>
      <td>-0.255578</td>
      <td>-0.265683</td>
      <td>-0.297872</td>
      <td>-0.269670</td>
      <td>-0.305098</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.114833</td>
      <td>0.102960</td>
      <td>0.014403</td>
      <td>-0.106258</td>
      <td>0.042066</td>
      <td>-0.020958</td>
      <td>0.074008</td>
      <td>0.074764</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.105957</td>
      <td>0.294110</td>
      <td>0.214385</td>
      <td>0.293106</td>
      <td>0.282949</td>
      <td>0.289779</td>
      <td>0.281255</td>
      <td>0.306457</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.979417</td>
      <td>0.710403</td>
      <td>0.832442</td>
      <td>0.876844</td>
      <td>0.794385</td>
      <td>0.765549</td>
      <td>0.777542</td>
      <td>0.617943</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="add-the-group-feature-back-in">
<h2>Add the group feature back in<a class="headerlink" href="#add-the-group-feature-back-in" title="Permalink to this headline">¶</a></h2>
<p>Since the data is now fully processed and ready for clustering, we can add the <em>‘group’</em> column back in as it will be needed later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp_sd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_vpp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">df_vpp_sd</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp_sd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>-0.273711</td>
      <td>0.258373</td>
      <td>-0.236811</td>
      <td>0.103057</td>
      <td>-0.381986</td>
      <td>-0.473107</td>
      <td>0.609875</td>
      <td>0.223459</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>-0.158959</td>
      <td>0.211519</td>
      <td>0.602357</td>
      <td>-0.462825</td>
      <td>-0.190765</td>
      <td>-0.224575</td>
      <td>0.026794</td>
      <td>0.515177</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>-0.242151</td>
      <td>0.177420</td>
      <td>0.214385</td>
      <td>-0.492437</td>
      <td>-0.355720</td>
      <td>-0.455659</td>
      <td>0.222972</td>
      <td>0.487393</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>-0.298645</td>
      <td>0.277743</td>
      <td>-0.552474</td>
      <td>-0.075495</td>
      <td>-0.265683</td>
      <td>-0.297872</td>
      <td>0.504985</td>
      <td>0.329268</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>-0.018640</td>
      <td>0.181119</td>
      <td>0.747803</td>
      <td>-0.298616</td>
      <td>-0.272331</td>
      <td>-0.479506</td>
      <td>0.038330</td>
      <td>0.113618</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h1>=============================================================<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="consideration-of-clustering-algorithms">
<h1>Consideration of Clustering Algorithms<a class="headerlink" href="#consideration-of-clustering-algorithms" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id10">
<h1>=============================================================<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h1>
<p>There are a number of clustering algorithms which we could implement. Below, we try the <em>KMeans</em> and <em>Spectral Clustering</em> algorithms and analyse how these perform on the data in question.</p>
<p>To determine which algorithm is more appropriate to the dataset, we will measure their performance using the <em>Silhouette Coefficient</em>. The Silhouette Coefficient of a data point quantifies how similar a data point is to its own cluster compared to other clusters. We will use the mean Silhouette Coefficient across all data points to compare the performace of algorithms.</p>
<p>The <strong>Silhouette Coefficient</strong> for a particular data point is calculated by the below formula:</p>
<div class="math notranslate nohighlight">
\[s = \frac{b - a}{max(a, b)}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><strong>a</strong> is the mean distance between a data point and all other points in the same cluster. (the mean intra-cluster distance)</p></li>
<li><p><strong>b</strong> is the mean distance between a data point and all other points in the <em>next nearest cluster</em>. (the mean nearest-cluster distance)</p></li>
</ul>
<p>The Silhouette score can assume values between -1 and 1. Scores closer to -1 indicate incorrect clustering whereas those nearer to +1 indicate highly dense clustering. Scores around zero are indicative of overlapping clusters. Therefore, a good indicator of what clustering algorithm to choose would be the one whose mean Silhouette Coefficient is nearest to 1.</p>
<p>Peter J. Rousseeuw (1987). “Silhouettes: a Graphical Aid to the Interpretation and Validation of Cluster Analysis”. Computational and Applied Mathematics 20: 53–65. doi:10.1016/0377-0427(87)90125-7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cluster</span> <span class="o">=</span> <span class="n">df_vpp_sd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="silhouette-scores-for-the-kmeans-algorithm">
<h2>Silhouette Scores for the KMeans Algorithm<a class="headerlink" href="#silhouette-scores-for-the-kmeans-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Below the KMeans algorithm is executed with various different numbers of clusters (from 2 clusters to 10). The mean Silhouette Coefficient (or more simply, the <em>Silhouette Score</em>) for the clusters produced is calculated for each execution of the algorithm. These scores are plotted below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialise empty list for the Silhouette Scores for KMeans model</span>
<span class="n">s_scores_km</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">num_clusters_to_iter</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="c1"># Running algorithm and calculating Silhouette Score</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num_clusters_to_iter</span><span class="p">:</span>
    
    <span class="c1"># Building the clustering model </span>
    <span class="n">km_model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># Training the model and storing the predicted cluster labels</span>
    <span class="n">km_labels</span> <span class="o">=</span> <span class="n">km_model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span>
    
    <span class="c1"># Evaluating the performance and adding score to list</span>
    <span class="n">s_scores_km</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">,</span> <span class="n">km_labels</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">s_scores_km</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Silhouette Scores for Different Numbers of Clusters for KMeans Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_55_0.png" src="_images/Clustering_55_0.png" />
</div>
</div>
<div class="section" id="plot-the-elbow-curve-of-the-distortion-that-each-cluster-number-gives">
<h3>Plot the elbow curve of the distortion that each cluster number gives<a class="headerlink" href="#plot-the-elbow-curve-of-the-distortion-that-each-cluster-number-gives" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Need to figure out where this goes</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iterate</span><span class="p">,</span> <span class="n">distortions</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distortion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The Elbow Method displaying the optimal number of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">47</span><span class="o">-</span><span class="mi">05941</span><span class="n">d52e3a4</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#Need to figure out where this goes</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iterate</span><span class="p">,</span> <span class="n">distortions</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distortion&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;num_clusters_to_iterate&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="silhouette-scores-for-spectral-clustering-algorithm">
<h2>Silhouette Scores for Spectral Clustering Algorithm<a class="headerlink" href="#silhouette-scores-for-spectral-clustering-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In order to explore more options for clustering, we are going to test the performance of two different implementations of the Spectral Clustering algorithm. One implementation constructs the <em>affinity matrix</em> using a radial basis function (RBF) kernel (aka Gaussian kernel) while the other constructs this matrix by computing a graph of nearest neighbors.</p>
<div class="section" id="spectral-clustering-with-affinity-rbf">
<h3>Spectral Clustering with <em>affinity=’rbf’</em><a class="headerlink" href="#spectral-clustering-with-affinity-rbf" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialise empty list for the Silhouette Scores for Spectral &#39;rbf&#39; model</span>
<span class="n">s_scores_rbf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Running algorithm and calculating Silhouette Score</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num_clusters_to_iter</span><span class="p">:</span>
    
    <span class="c1"># Building the clustering model </span>
    <span class="n">spectral_model_rbf</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">affinity</span> <span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>

    <span class="c1"># Training the model and storing the predicted cluster labels</span>
    <span class="n">labels_rbf</span> <span class="o">=</span> <span class="n">spectral_model_rbf</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span>
    
    <span class="c1"># Adding Silhouette Score to list</span>
    <span class="n">s_scores_rbf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">,</span> <span class="n">labels_rbf</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">s_scores_rbf</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Silhouette Scores for Different Numbers of Clusters for Spectral </span><span class="se">\&#39;</span><span class="s1">rbf</span><span class="se">\&#39;</span><span class="s1"> Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_61_0.png" src="_images/Clustering_61_0.png" />
</div>
</div>
</div>
<div class="section" id="spectral-clustering-with-affinity-nearest-neighbors">
<h3>Spectral Clustering with <em>affinity=’nearest_neighbors’</em><a class="headerlink" href="#spectral-clustering-with-affinity-nearest-neighbors" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialise empty list for the Silhouette Scores for Spectral &#39;nearest_neighbors&#39; model</span>
<span class="n">s_scores_nn</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Running algo and storing Silhouette Score for each no. of clusters</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num_clusters_to_iter</span><span class="p">:</span>
    
    <span class="c1"># Building the clustering model</span>
    <span class="n">spectral_model_nn</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">affinity</span> <span class="o">=</span><span class="s1">&#39;nearest_neighbors&#39;</span><span class="p">)</span>

    <span class="c1"># Training the model and storing the predicted cluster labels</span>
    <span class="n">labels_nn</span> <span class="o">=</span> <span class="n">spectral_model_nn</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span>
    
    <span class="c1"># Evaluating the performance </span>
    <span class="n">s_scores_nn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">,</span> <span class="n">labels_nn</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">s_scores_nn</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Silhouette Scores for Different Numbers of Clusters for Spectral </span><span class="se">\&#39;</span><span class="s1">nn</span><span class="se">\&#39;</span><span class="s1"> Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_63_0.png" src="_images/Clustering_63_0.png" />
</div>
</div>
<p>Splitting the data into <em>two clusters</em> produces the best Silhouette Scores for all three algorithms. This is probably to be expected as the sample of data subjects can be segmented into two groups as we saw at the start; <em>‘young’</em> and <em>‘old’</em> and there is a good chance that the two clusters encapsulates these two groups. However, to confirm this, we will attempt to visualise these clusters.</p>
<p>We will test the Spectral Clustering algorithm, with ‘rbf’ used to construct the affinity matrix, using two clusters.</p>
</div>
</div>
</div>
<div class="section" id="id11">
<h1>=============================================================<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="cluster-the-data">
<h1>4. Cluster the data<a class="headerlink" href="#cluster-the-data" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id12">
<h1>=============================================================<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Building Spectral model with 2 clusters</span>
<span class="n">spectral_model</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">affinity</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>

<span class="c1"># Training the model and storing predicted cluster labels</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">spectral_model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In order to visualise these clusters, we will need to reduce the dimensionality of the original Dataframe so that we can represent each data point in a two dimensional space. This can be achieved by performing <strong>Principal Component Analysis</strong> on the data. This is done below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Move PCA up here?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Choose more clusters</span>
<span class="c1">#The next most suitable combination of num_clusters/model is kmeans with 6 clusters</span>
<span class="c1">#Confirm this with elbow curve</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">standard_train_array</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="find-out-which-of-the-clusters-each-df-row-is-in">
<h2>Find out which of the clusters each df row is in<a class="headerlink" href="#find-out-which-of-the-clusters-each-df-row-is-in" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id13">
<h3>Cluster the data<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clustering</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">assign_labels</span><span class="o">=</span><span class="s2">&quot;discretize&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">standard_train_array</span><span class="p">)</span>
<span class="n">clusters_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-the-centroids-of-the-clusters">
<h3>Calculate the centroids of the clusters<a class="headerlink" href="#calculate-the-centroids-of-the-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">standard_train_array</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-a-new-column-to-the-original-data-with-the-cluster-each-row-is-in">
<h3>Add a new column to the original data with the cluster each row is in<a class="headerlink" href="#add-a-new-column-to-the-original-data-with-the-cluster-each-row-is-in" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_df_nd_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">original_df</span><span class="p">,</span> <span class="n">clusters_label</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_df_nd_cluster</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id14">
<h1>=============================================================<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="principal-component-analysis">
<h1>5. Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id15">
<h1>=============================================================<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h1>
<p>There are eight parameters in this model so principal component analysis is performed below on the data before performing Spectral clustering.</p>
<div class="section" id="inspect-dataframe-which-pca-is-being-performed-on">
<h2>Inspect dataframe which PCA is being performed on<a class="headerlink" href="#inspect-dataframe-which-pca-is-being-performed-on" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-pca-to-project-the-data-to-2-dimensions">
<h2>Use PCA to project the data to 2 dimensions<a class="headerlink" href="#use-pca-to-project-the-data-to-2-dimensions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">principal_components_array</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">standard_train_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="look-at-how-much-variance-these-2-axes-explain">
<h2>Look at how much variance these 2 axes explain<a class="headerlink" href="#look-at-how-much-variance-these-2-axes-explain" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-these-principal-component-columns-to-the-rest-of-the-data">
<h2>Add these principal component columns to the rest of the data<a class="headerlink" href="#add-these-principal-component-columns-to-the-rest-of-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">principal_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">principal_components_array</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Principal_Component_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Principal_Component_2&#39;</span><span class="p">])</span>
<span class="n">principal_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">full_df_nd_cluster</span><span class="p">,</span> <span class="n">principal_df</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id16">
<h1>=============================================================<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="plot-the-clusters-with-the-pca-axes">
<h1>6. Plot the clusters with the PCA axes<a class="headerlink" href="#plot-the-clusters-with-the-pca-axes" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id17">
<h1>=============================================================<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h1>
<div class="section" id="plot-the-clusters">
<h2>Plot the clusters<a class="headerlink" href="#plot-the-clusters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="choose-the-columns-to-plot">
<h3>Choose the columns to plot<a class="headerlink" href="#choose-the-columns-to-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span> <span class="o">=</span> <span class="n">final_df</span><span class="p">[</span><span class="s1">&#39;Principal_Component_1&#39;</span><span class="p">]</span>
<span class="n">pc2</span> <span class="o">=</span> <span class="n">final_df</span><span class="p">[</span><span class="s1">&#39;Principal_Component_2&#39;</span><span class="p">]</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualise-2d-projection">
<h3>Visualise 2D projection<a class="headerlink" href="#visualise-2d-projection" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Plotting the dataset accross the 2 principal components&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">target</span> <span class="o">==</span> <span class="n">group</span><span class="p">],</span> <span class="n">pc2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">target</span> <span class="o">==</span> <span class="n">group</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-original-data">
<h3>Plot the original data<a class="headerlink" href="#plot-the-original-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="p">,</span> <span class="n">pc2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-data-colouring-the-different-groups">
<h3>Plot the data colouring the different groups<a class="headerlink" href="#plot-the-data-colouring-the-different-groups" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="p">,</span> <span class="n">pc2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">group</span><span class="o">==</span><span class="s2">&quot;young&quot;</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-this-data-colouring-the-different-clusters">
<h3>Plot this data colouring the different clusters<a class="headerlink" href="#plot-this-data-colouring-the-different-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="p">,</span> <span class="n">pc2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cluster</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-this-data-with-the-clusters-and-their-centroids">
<h3>Plot this data with the clusters and their centroids<a class="headerlink" href="#plot-this-data-with-the-clusters-and-their-centroids" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="p">,</span> <span class="n">pc2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroids</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centroids</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id18">
<h1>=============================================================<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="analyse-the-clusters">
<h1>7. Analyse the clusters<a class="headerlink" href="#analyse-the-clusters" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="id19">
<h1>=============================================================<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h1>
<div class="section" id="see-how-the-old-and-young-fall-into-these-clusters">
<h2>See how the ‘Old’ and ‘Young’ fall into these clusters<a class="headerlink" href="#see-how-the-old-and-young-fall-into-these-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-dataframe-showing-how-many-people-people-fell-into-each-cluster">
<h3>Create a dataframe showing how many people people fell into each cluster<a class="headerlink" href="#create-a-dataframe-showing-how-many-people-people-fell-into-each-cluster" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final_df</span><span class="p">[[</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="change-young-to-1-and-old-to-np-nan">
<h3>Change ‘young’ to 1 and ‘old’ to np.nan<a class="headerlink" href="#change-young-to-1-and-old-to-np-nan" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-dataframe-showing-how-many-young-people-fell-into-each-cluster">
<h3>Create a dataframe showing how many young people fell into each cluster<a class="headerlink" href="#create-a-dataframe-showing-how-many-young-people-fell-into-each-cluster" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">young_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final_df</span><span class="p">[[</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;Young&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-a-dataframe-showing-how-many-old-people-fell-into-each-cluster">
<h3>Create a dataframe showing how many old people fell into each cluster<a class="headerlink" href="#create-a-dataframe-showing-how-many-old-people-fell-into-each-cluster" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">old_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">final_df</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;Old&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="output-how-many-young-and-old-people-fell-into-each-cluster">
<h3>Output how many ‘young’ and ‘old’ people fell into each cluster<a class="headerlink" href="#output-how-many-young-and-old-people-fell-into-each-cluster" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_cluster_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">young_cluster_df</span><span class="p">,</span> <span class="n">old_cluster_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Cluster&quot;</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='right-next' id="next-link" href="Introduction and Description of Datasets.html" title="next page">Introdcution and Description of Datasets</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>